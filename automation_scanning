#!/usr/bin/env python3

import subprocess
import argparse
import os


def run_nmap(target):
    print(f"[+] Running Nmap scan on {target}...")
    nmap_output = "nmap_scan.txt"
    subprocess.run(["nmap", "-sV", "-oN", nmap_output, target])
    print(f"[+] Nmap scan saved to {nmap_output}")

def run_nikto(target):
    print(f"[+] Running Nikto scan on {target}...")
    nikto_output = "nikto_scan.txt"
    subprocess.run(["nikto", "-h", target, "-output", nikto_output])
    print(f"[+] Nikto scan saved to {nikto_output}")

def run_sslscan(target):
    print(f"[+] Running SSLScan on {target}...")
    subprocess.run(["sslscan", target])
    print("[+] SSLScan complete")

#def run_bloodhound(target, username, password):
    #print(f"[+] Running BloodHound scan on {target} with user {username}...")
    #subprocess.run(["bloodhound-python", "-u", username, "-p", password, "-ip", target])
    #print("[+] BloodHound scan complete")

#def run_beef(beef_url):
    #print(f"[+] Running Browser Exploitation Framework on {beef_url}...")
    #subprocess.run(["beef", beef_url])
    #print("[+] BEEF scan complete")

def run_uniscan(target):
    print(f"[+] Running Uniscan on {target}...")
    uniscan_output = "uniscan_scan.txt"
    subprocess.run(["uniscan", "-u", target, "-o", uniscan_output])
    print(f"[+] Uniscan scan saved to {uniscan_output}")

def run_commix(target):
    print(f"[+] Running Commix on {target}...")
    commix_output = "commix_scan.txt"
    subprocess.run(["commix", "--url", target, "--batch", "--output-dir=.", "--output-file", commix_output])
    print(f"[+] Commix scan saved to {commix_output}")

def run_dismap(target):
    print(f"[+] Running Dismap on {target}...")
    dismap_output = "dismap_scan.txt"
    subprocess.run(["dismap", "-u", target, "-o", dismap_output])
    print(f"[+] Dismap scan saved to {dismap_output}")

#def run_gobuster(target, wordlist):
    #print(f"[+] Running Gobuster on {target}...")
    #gobuster_output = "gobuster_scan.txt"
    #subprocess.run(["gobuster", "dir", "-u", target, "-w", wordlist, "-o", gobuster_output])
    #print(f"[+] Gobuster scan saved to {gobuster_output}")

def run_xxhunter(target):
    print(f"[+] Running XXHunter on {target}...")
    xxhunter_output = "xxhunter_scan.txt"
    subprocess.run(["xxhunter", "-u", target, "-o", xxhunter_output])
    print(f"[+] XXHunter scan saved to {xxhunter_output}")


def main():
    parser = argparse.ArgumentParser(description="Automate multiple security scans on Kali")
    parser.add_argument("target", help="Target IP or domain")
    #parser.add_argument("username", help="Username for BloodHound")
    #parser.add_argument("password", help="Password for BloodHound")
    #parser.add_argument("beef_url", help="Target URL for BEEF")
    #parser.add_argument("wordlist", help="Path to wordlist for Gobuster")
    args = parser.parse_args()

    run_nmap(args.target)
    run_nikto(args.target)
    run_sslscan(args.target)
    #run_bloodhound(args.target, args.username, args.password)
    #run_beef(args.beef_url)
    run_uniscan(args.target)
    run_commix(args.target)
    run_dismap(args.target)
    #run_gobuster(args.target, args.wordlist)
    run_xxhunter(args.target)

if __name__ == "__main__":
    main()

